todo:

continue refactor
fix bug where segfault if request points to directory